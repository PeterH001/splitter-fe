{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nlet CreateExpenseComponent = class CreateExpenseComponent {\n  constructor(expenseService, groupService, route, router) {\n    this.expenseService = expenseService;\n    this.groupService = groupService;\n    this.route = route;\n    this.router = router;\n    this.createGroupForm = new FormGroup({\n      name: new FormControl('', [Validators.required]),\n      payerId: new FormControl(-1, [Validators.required, Validators.min(0)]),\n      groupId: new FormControl(-1, [Validators.min(0), Validators.required]),\n      amount: new FormControl('', Validators.required),\n      currency: new FormControl('', Validators.required),\n      category: new FormControl('', Validators.required),\n      distributionType: new FormControl('', Validators.required),\n      description: new FormControl(''),\n      userIds: new FormControl([], [Validators.required, Validators.minLength(1)])\n    });\n    this.selectedGroupMembers = [];\n    this.memberProportions = {};\n  }\n  ngOnInit() {\n    this.expenseService.getExpenseCategories().subscribe(result => {\n      this.categories = result;\n      console.log(this.categories);\n    });\n    const groupId = this.route.snapshot.paramMap.get('id');\n    this.groupId = parseInt(groupId);\n    const groupIdControl = this.createGroupForm.get('groupId');\n    if (groupIdControl !== null) {\n      groupIdControl.setValue(this.groupId);\n    }\n    this.groupService.getGroupMembers(this.groupId).subscribe(result => {\n      this.groupMembers = result;\n      console.log('result: ', result);\n      console.log('groupmembers: ', this.groupMembers);\n    });\n    this.expenseService.getCurrencies().subscribe(result => {\n      this.currencies = result;\n    });\n    this.expenseService.getExpenseDistributions().subscribe(result => {\n      this.distributionTypes = result;\n      console.log(this.distributionTypes);\n    });\n  }\n  toggleSelection(userId) {\n    if (this.selectedGroupMembers.includes(userId)) {\n      this.selectedGroupMembers = this.selectedGroupMembers.filter(item => item !== userId);\n    } else {\n      this.selectedGroupMembers.push(userId);\n    }\n    this.createGroupForm.get('userIds')?.setValue(this.selectedGroupMembers);\n    console.log('this.selectedGroupMembers: ', this.selectedGroupMembers);\n  }\n  updateProportions(id, percent) {\n    if (percent > 0) {\n      this.memberProportions[id] = percent;\n    } else {\n      delete this.memberProportions[id];\n    }\n  }\n  isChecked(id) {\n    return this.selectedGroupMembers.find(userId => userId === id) ? true : false;\n  }\n  goBack() {\n    this.router.navigate(['/groupdetails', this.groupId]);\n  }\n  submitForm() {\n    // console.log(this.createGroupForm.value);\n    this.expenseService.createExpense(this.createGroupForm.value).subscribe(() => {\n      this.router.navigate(['/groupdetails', this.groupId]);\n    });\n  }\n  get name() {\n    return this.createGroupForm.get('name');\n  }\n  get currency() {\n    return this.createGroupForm.get('currency');\n  }\n  get amount() {\n    return this.createGroupForm.get('amount');\n  }\n  get payerId() {\n    return this.createGroupForm.get('payerId');\n  }\n  get category() {\n    return this.createGroupForm.get('category');\n  }\n  get distributionType() {\n    return this.createGroupForm.get('distributionType');\n  }\n  get userIds() {\n    return this.createGroupForm.get('userIds');\n  }\n};\nCreateExpenseComponent = __decorate([Component({\n  selector: 'app-create-expense',\n  templateUrl: './create-expense.component.html',\n  styleUrls: ['./create-expense.component.css']\n})], CreateExpenseComponent);\nexport { CreateExpenseComponent };","map":{"version":3,"names":["Component","FormControl","FormGroup","Validators","CreateExpenseComponent","constructor","expenseService","groupService","route","router","createGroupForm","name","required","payerId","min","groupId","amount","currency","category","distributionType","description","userIds","minLength","selectedGroupMembers","memberProportions","ngOnInit","getExpenseCategories","subscribe","result","categories","console","log","snapshot","paramMap","get","parseInt","groupIdControl","setValue","getGroupMembers","groupMembers","getCurrencies","currencies","getExpenseDistributions","distributionTypes","toggleSelection","userId","includes","filter","item","push","updateProportions","id","percent","isChecked","find","goBack","navigate","submitForm","createExpense","value","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\Peti\\nest_projects\\splitwise\\frontend\\splitter-fe\\src\\app\\expense\\create-expense\\create-expense.component.ts"],"sourcesContent":["import { Location } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ExpenseService } from 'src/app/services/expense.service';\nimport { GroupService } from 'src/app/services/group.service';\nimport { distributionTypesEnumMappings as distributionTypesEnumMappings } from '../enum';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\n\n@Component({\n  selector: 'app-create-expense',\n  templateUrl: './create-expense.component.html',\n  styleUrls: ['./create-expense.component.css'],\n})\nexport class CreateExpenseComponent implements OnInit {\n  createGroupForm = new FormGroup({\n    name: new FormControl('', [Validators.required]),\n    payerId: new FormControl(-1, [Validators.required, Validators.min(0)]),\n    groupId: new FormControl(-1, [Validators.min(0), Validators.required]),\n    amount: new FormControl('', Validators.required),\n    currency: new FormControl('', Validators.required),\n    category: new FormControl('', Validators.required),\n    distributionType: new FormControl('', Validators.required),\n    description: new FormControl(''),\n    userIds: new FormControl<number[]>(\n      [],\n      [Validators.required, Validators.minLength(1)]\n    ),\n  });\n\n  groupId!: number;\n  categories!: string[];\n  distributionTypes!: string[];\n  currencies!: string[];\n  groupMembers!: { id: number; username: string }[];\n\n  selectedGroupMembers: number[] = [];\n  memberProportions: { [groupMemberId: number]: number } = {};\n  constructor(\n    private expenseService: ExpenseService,\n    private groupService: GroupService,\n    private route: ActivatedRoute,\n    private router: Router\n  ) {}\n  ngOnInit(): void {\n    this.expenseService.getExpenseCategories().subscribe((result) => {\n      this.categories = result;\n      console.log(this.categories);\n    });\n    const groupId = this.route.snapshot.paramMap.get('id');\n    this.groupId = parseInt(groupId!);\n    const groupIdControl = this.createGroupForm.get('groupId');\n    if (groupIdControl !== null) {\n      groupIdControl.setValue(this.groupId);\n    }\n\n    this.groupService.getGroupMembers(this.groupId).subscribe((result) => {\n      this.groupMembers = result;\n      console.log('result: ', result);\n      console.log('groupmembers: ', this.groupMembers);\n    });\n\n    this.expenseService.getCurrencies().subscribe((result) => {\n      this.currencies = result;\n    });\n    this.expenseService.getExpenseDistributions().subscribe((result) => {\n      this.distributionTypes = result;\n      console.log(this.distributionTypes);\n    });\n  }\n\n  toggleSelection(userId: number) {\n    if (this.selectedGroupMembers.includes(userId)) {\n      this.selectedGroupMembers = this.selectedGroupMembers.filter(\n        (item) => item !== userId\n      );\n    } else {\n      this.selectedGroupMembers.push(userId);\n    }\n    this.createGroupForm.get('userIds')?.setValue(this.selectedGroupMembers);\n    console.log('this.selectedGroupMembers: ', this.selectedGroupMembers);\n  }\n\n  updateProportions(id: number, percent: number) {\n    if (percent > 0) {\n      this.memberProportions[id] = percent;\n    } else {\n      delete this.memberProportions[id];\n    }\n  }\n\n  isChecked(id: number) {\n    return this.selectedGroupMembers.find((userId) => userId === id)\n      ? true\n      : false;\n  }\n\n  goBack() {\n    this.router.navigate(['/groupdetails', this.groupId]);\n  }\n\n  submitForm(): void {\n    // console.log(this.createGroupForm.value);\n\n    this.expenseService\n      .createExpense(this.createGroupForm.value)\n      .subscribe(() => {\n        this.router.navigate(['/groupdetails', this.groupId]);\n      });\n  }\n  get name() {\n    return this.createGroupForm.get('name');\n  }\n  get currency() {\n    return this.createGroupForm.get('currency');\n  }\n  get amount() {\n    return this.createGroupForm.get('amount');\n  }\n  get payerId() {\n    return this.createGroupForm.get('payerId');\n  }\n  get category() {\n    return this.createGroupForm.get('category');\n  }\n  get distributionType() {\n    return this.createGroupForm.get('distributionType');\n  }\n  get userIds() {\n    return this.createGroupForm.get('userIds');\n  }\n}\n"],"mappings":";AACA,SAASA,SAAS,QAAgB,eAAe;AAKjD,SAASC,WAAW,EAAEC,SAAS,EAAEC,UAAU,QAAQ,gBAAgB;AAOnE,IAAaC,sBAAsB,GAAnC,MAAaA,sBAAsB;EAwBjCC,YACUC,cAA8B,EAC9BC,YAA0B,EAC1BC,KAAqB,EACrBC,MAAc;IAHd,KAAAH,cAAc,GAAdA,cAAc;IACd,KAAAC,YAAY,GAAZA,YAAY;IACZ,KAAAC,KAAK,GAALA,KAAK;IACL,KAAAC,MAAM,GAANA,MAAM;IA3BhB,KAAAC,eAAe,GAAG,IAAIR,SAAS,CAAC;MAC9BS,IAAI,EAAE,IAAIV,WAAW,CAAC,EAAE,EAAE,CAACE,UAAU,CAACS,QAAQ,CAAC,CAAC;MAChDC,OAAO,EAAE,IAAIZ,WAAW,CAAC,CAAC,CAAC,EAAE,CAACE,UAAU,CAACS,QAAQ,EAAET,UAAU,CAACW,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;MACtEC,OAAO,EAAE,IAAId,WAAW,CAAC,CAAC,CAAC,EAAE,CAACE,UAAU,CAACW,GAAG,CAAC,CAAC,CAAC,EAAEX,UAAU,CAACS,QAAQ,CAAC,CAAC;MACtEI,MAAM,EAAE,IAAIf,WAAW,CAAC,EAAE,EAAEE,UAAU,CAACS,QAAQ,CAAC;MAChDK,QAAQ,EAAE,IAAIhB,WAAW,CAAC,EAAE,EAAEE,UAAU,CAACS,QAAQ,CAAC;MAClDM,QAAQ,EAAE,IAAIjB,WAAW,CAAC,EAAE,EAAEE,UAAU,CAACS,QAAQ,CAAC;MAClDO,gBAAgB,EAAE,IAAIlB,WAAW,CAAC,EAAE,EAAEE,UAAU,CAACS,QAAQ,CAAC;MAC1DQ,WAAW,EAAE,IAAInB,WAAW,CAAC,EAAE,CAAC;MAChCoB,OAAO,EAAE,IAAIpB,WAAW,CACtB,EAAE,EACF,CAACE,UAAU,CAACS,QAAQ,EAAET,UAAU,CAACmB,SAAS,CAAC,CAAC,CAAC,CAAC;KAEjD,CAAC;IAQF,KAAAC,oBAAoB,GAAa,EAAE;IACnC,KAAAC,iBAAiB,GAAwC,EAAE;EAMxD;EACHC,QAAQA,CAAA;IACN,IAAI,CAACnB,cAAc,CAACoB,oBAAoB,EAAE,CAACC,SAAS,CAAEC,MAAM,IAAI;MAC9D,IAAI,CAACC,UAAU,GAAGD,MAAM;MACxBE,OAAO,CAACC,GAAG,CAAC,IAAI,CAACF,UAAU,CAAC;IAC9B,CAAC,CAAC;IACF,MAAMd,OAAO,GAAG,IAAI,CAACP,KAAK,CAACwB,QAAQ,CAACC,QAAQ,CAACC,GAAG,CAAC,IAAI,CAAC;IACtD,IAAI,CAACnB,OAAO,GAAGoB,QAAQ,CAACpB,OAAQ,CAAC;IACjC,MAAMqB,cAAc,GAAG,IAAI,CAAC1B,eAAe,CAACwB,GAAG,CAAC,SAAS,CAAC;IAC1D,IAAIE,cAAc,KAAK,IAAI,EAAE;MAC3BA,cAAc,CAACC,QAAQ,CAAC,IAAI,CAACtB,OAAO,CAAC;;IAGvC,IAAI,CAACR,YAAY,CAAC+B,eAAe,CAAC,IAAI,CAACvB,OAAO,CAAC,CAACY,SAAS,CAAEC,MAAM,IAAI;MACnE,IAAI,CAACW,YAAY,GAAGX,MAAM;MAC1BE,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEH,MAAM,CAAC;MAC/BE,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAE,IAAI,CAACQ,YAAY,CAAC;IAClD,CAAC,CAAC;IAEF,IAAI,CAACjC,cAAc,CAACkC,aAAa,EAAE,CAACb,SAAS,CAAEC,MAAM,IAAI;MACvD,IAAI,CAACa,UAAU,GAAGb,MAAM;IAC1B,CAAC,CAAC;IACF,IAAI,CAACtB,cAAc,CAACoC,uBAAuB,EAAE,CAACf,SAAS,CAAEC,MAAM,IAAI;MACjE,IAAI,CAACe,iBAAiB,GAAGf,MAAM;MAC/BE,OAAO,CAACC,GAAG,CAAC,IAAI,CAACY,iBAAiB,CAAC;IACrC,CAAC,CAAC;EACJ;EAEAC,eAAeA,CAACC,MAAc;IAC5B,IAAI,IAAI,CAACtB,oBAAoB,CAACuB,QAAQ,CAACD,MAAM,CAAC,EAAE;MAC9C,IAAI,CAACtB,oBAAoB,GAAG,IAAI,CAACA,oBAAoB,CAACwB,MAAM,CACzDC,IAAI,IAAKA,IAAI,KAAKH,MAAM,CAC1B;KACF,MAAM;MACL,IAAI,CAACtB,oBAAoB,CAAC0B,IAAI,CAACJ,MAAM,CAAC;;IAExC,IAAI,CAACnC,eAAe,CAACwB,GAAG,CAAC,SAAS,CAAC,EAAEG,QAAQ,CAAC,IAAI,CAACd,oBAAoB,CAAC;IACxEO,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAE,IAAI,CAACR,oBAAoB,CAAC;EACvE;EAEA2B,iBAAiBA,CAACC,EAAU,EAAEC,OAAe;IAC3C,IAAIA,OAAO,GAAG,CAAC,EAAE;MACf,IAAI,CAAC5B,iBAAiB,CAAC2B,EAAE,CAAC,GAAGC,OAAO;KACrC,MAAM;MACL,OAAO,IAAI,CAAC5B,iBAAiB,CAAC2B,EAAE,CAAC;;EAErC;EAEAE,SAASA,CAACF,EAAU;IAClB,OAAO,IAAI,CAAC5B,oBAAoB,CAAC+B,IAAI,CAAET,MAAM,IAAKA,MAAM,KAAKM,EAAE,CAAC,GAC5D,IAAI,GACJ,KAAK;EACX;EAEAI,MAAMA,CAAA;IACJ,IAAI,CAAC9C,MAAM,CAAC+C,QAAQ,CAAC,CAAC,eAAe,EAAE,IAAI,CAACzC,OAAO,CAAC,CAAC;EACvD;EAEA0C,UAAUA,CAAA;IACR;IAEA,IAAI,CAACnD,cAAc,CAChBoD,aAAa,CAAC,IAAI,CAAChD,eAAe,CAACiD,KAAK,CAAC,CACzChC,SAAS,CAAC,MAAK;MACd,IAAI,CAAClB,MAAM,CAAC+C,QAAQ,CAAC,CAAC,eAAe,EAAE,IAAI,CAACzC,OAAO,CAAC,CAAC;IACvD,CAAC,CAAC;EACN;EACA,IAAIJ,IAAIA,CAAA;IACN,OAAO,IAAI,CAACD,eAAe,CAACwB,GAAG,CAAC,MAAM,CAAC;EACzC;EACA,IAAIjB,QAAQA,CAAA;IACV,OAAO,IAAI,CAACP,eAAe,CAACwB,GAAG,CAAC,UAAU,CAAC;EAC7C;EACA,IAAIlB,MAAMA,CAAA;IACR,OAAO,IAAI,CAACN,eAAe,CAACwB,GAAG,CAAC,QAAQ,CAAC;EAC3C;EACA,IAAIrB,OAAOA,CAAA;IACT,OAAO,IAAI,CAACH,eAAe,CAACwB,GAAG,CAAC,SAAS,CAAC;EAC5C;EACA,IAAIhB,QAAQA,CAAA;IACV,OAAO,IAAI,CAACR,eAAe,CAACwB,GAAG,CAAC,UAAU,CAAC;EAC7C;EACA,IAAIf,gBAAgBA,CAAA;IAClB,OAAO,IAAI,CAACT,eAAe,CAACwB,GAAG,CAAC,kBAAkB,CAAC;EACrD;EACA,IAAIb,OAAOA,CAAA;IACT,OAAO,IAAI,CAACX,eAAe,CAACwB,GAAG,CAAC,SAAS,CAAC;EAC5C;CACD;AArHY9B,sBAAsB,GAAAwD,UAAA,EALlC5D,SAAS,CAAC;EACT6D,QAAQ,EAAE,oBAAoB;EAC9BC,WAAW,EAAE,iCAAiC;EAC9CC,SAAS,EAAE,CAAC,gCAAgC;CAC7C,CAAC,C,EACW3D,sBAAsB,CAqHlC;SArHYA,sBAAsB"},"metadata":{},"sourceType":"module","externalDependencies":[]}