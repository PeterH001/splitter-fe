{"ast":null,"code":"import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/auth.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction LoginComponent_div_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵtext(1, \" Incorrect email or password. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21);\n    i0.ɵɵtext(1, \" Provide an email address. \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst ROLE_ADMIN = 'admin';\nconst ROLE_USER = 'user';\nclass LoginComponent {\n  constructor(authService, router) {\n    this.authService = authService;\n    this.router = router;\n    this.loginForm2 = new FormGroup({\n      email: new FormControl('', [Validators.required, Validators.email]),\n      password: new FormControl('', [Validators.required])\n    });\n  }\n  login(loginForm) {\n    console.log(loginForm.value);\n    console.log('form is submitted');\n    this.authService.login(loginForm.value).subscribe(response => {\n      const token = response.token;\n      const role = response.role;\n      this.authService.setToken(response.token);\n      this.authService.setRoles(response.role);\n      if (role === ROLE_ADMIN) {\n        this.router.navigate(['/admin']);\n      } else {\n        this.router.navigate(['/groups']);\n      }\n    }, error => {\n      console.log(error.message);\n    });\n  }\n  submitForm() {\n    this.authService.login(this.loginForm2.value).subscribe(response => {\n      const role = response.role;\n      this.authService.setToken(response.token);\n      this.authService.setRoles(response.role);\n      if (role === ROLE_ADMIN) {\n        this.router.navigate(['/admin']);\n      } else {\n        this.router.navigate(['/groups']);\n      }\n    }, error => {\n      if (error.status === 403) {\n        this.loginForm2.get('email')?.setErrors({\n          badCredentials: true\n        });\n      }\n    });\n  }\n  get email() {\n    return this.loginForm2.get('email');\n  }\n  static #_ = this.ɵfac = function LoginComponent_Factory(t) {\n    return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.Router));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoginComponent,\n    selectors: [[\"app-login\"]],\n    decls: 35,\n    vars: 3,\n    consts: [[1, \"row\", \"mb-4\"], [1, \"col\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"display-4\"], [1, \"row\", \"d-flex\", \"justify-content-center\"], [1, \"col-md-4\"], [3, \"ngSubmit\"], [\"loginForm\", \"ngForm\"], [1, \"row\"], [\"type\", \"email\", \"ngModel\", \"\", \"name\", \"email\", \"id\", \"email\", \"placeholder\", \"Enter your email\", 1, \"form-control\", \"mb-3\"], [\"type\", \"password\", \"ngModel\", \"\", \"name\", \"password\", \"id\", \"password\", \"placeholder\", \"Enter your password\", 1, \"form-control\", \"mb-3\"], [\"type\", \"submit\", \"value\", \"Login\", 1, \"btn\", \"btn-primary\", \"form-control\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"row\", \"mb-2\"], [1, \"form-group\"], [\"for\", \"email\"], [\"type\", \"email\", \"id\", \"email\", \"name\", \"email\", \"formControlName\", \"email\", \"required\", \"\", 1, \"form-control\"], [\"for\", \"password\"], [\"type\", \"password\", \"id\", \"password\", \"name\", \"password\", \"formControlName\", \"password\", \"required\", \"\", 1, \"form-control\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"form-control\"], [1, \"alert\", \"alert-danger\"]],\n    template: function LoginComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r3 = i0.ɵɵgetCurrentView();\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"span\", 3);\n        i0.ɵɵtext(4, \"Login\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(5, \"div\", 4)(6, \"div\", 5)(7, \"form\", 6, 7);\n        i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_7_listener() {\n          i0.ɵɵrestoreView(_r3);\n          const _r0 = i0.ɵɵreference(8);\n          return i0.ɵɵresetView(ctx.login(_r0));\n        });\n        i0.ɵɵelementStart(9, \"div\", 8)(10, \"div\", 1);\n        i0.ɵɵelement(11, \"input\", 9);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"div\", 8)(13, \"div\", 1);\n        i0.ɵɵelement(14, \"input\", 10);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 8)(16, \"div\", 1);\n        i0.ɵɵelement(17, \"input\", 11);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(18, \"form\", 12);\n        i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_18_listener() {\n          return ctx.submitForm();\n        });\n        i0.ɵɵelementStart(19, \"div\", 13)(20, \"div\", 1)(21, \"div\", 14)(22, \"label\", 15);\n        i0.ɵɵtext(23, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(24, \"input\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 14)(26, \"label\", 17);\n        i0.ɵɵtext(27, \"Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(28, \"input\", 18);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(29, LoginComponent_div_29_Template, 2, 0, \"div\", 19);\n        i0.ɵɵtemplate(30, LoginComponent_div_30_Template, 2, 0, \"div\", 19);\n        i0.ɵɵelementStart(31, \"div\", 8)(32, \"div\", 1)(33, \"button\", 20);\n        i0.ɵɵtext(34, \"Login\");\n        i0.ɵɵelementEnd()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(18);\n        i0.ɵɵproperty(\"formGroup\", ctx.loginForm2);\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngIf\", ctx.email == null ? null : ctx.email.errors == null ? null : ctx.email.errors[\"badCredentials\"]);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", (ctx.email == null ? null : ctx.email.errors == null ? null : ctx.email.errors[\"required\"]) && ((ctx.email == null ? null : ctx.email.touched) || (ctx.email == null ? null : ctx.email.dirty)));\n      }\n    },\n    dependencies: [i3.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm, i4.FormGroupDirective, i4.FormControlName],\n    styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}\nexport { LoginComponent };","map":{"version":3,"names":["FormControl","FormGroup","Validators","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ROLE_ADMIN","ROLE_USER","LoginComponent","constructor","authService","router","loginForm2","email","required","password","login","loginForm","console","log","value","subscribe","response","token","role","setToken","setRoles","navigate","error","message","submitForm","status","get","setErrors","badCredentials","_","ɵɵdirectiveInject","i1","AuthService","i2","Router","_2","selectors","decls","vars","consts","template","LoginComponent_Template","rf","ctx","ɵɵlistener","LoginComponent_Template_form_ngSubmit_7_listener","ɵɵrestoreView","_r3","_r0","ɵɵreference","ɵɵresetView","ɵɵelement","LoginComponent_Template_form_ngSubmit_18_listener","ɵɵtemplate","LoginComponent_div_29_Template","LoginComponent_div_30_Template","ɵɵadvance","ɵɵproperty","errors","touched","dirty"],"sources":["C:\\Users\\Peti\\nest_projects\\splitwise\\frontend\\splitter-fe\\src\\app\\login\\login.component.ts","C:\\Users\\Peti\\nest_projects\\splitwise\\frontend\\splitter-fe\\src\\app\\login\\login.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport { FormControl, FormGroup, NgForm, Validators } from '@angular/forms';\nimport { AuthService } from '../services/auth.service';\nimport { Router } from '@angular/router';\n\nconst ROLE_ADMIN: string = 'admin';\nconst ROLE_USER: string = 'user';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css'],\n})\nexport class LoginComponent {\n  constructor(private authService: AuthService, private router: Router) {}\n\n  loginForm2 = new FormGroup({\n    email: new FormControl('', [Validators.required, Validators.email]),\n    password: new FormControl('', [Validators.required]),\n  });\n  login(loginForm: NgForm) {\n    console.log(loginForm.value);\n    console.log('form is submitted');\n    this.authService.login(loginForm.value).subscribe(\n      (response: any) => {\n        const token = response.token;\n        const role = response.role;\n        this.authService.setToken(response.token);\n        this.authService.setRoles(response.role);\n        if (role === ROLE_ADMIN) {\n          this.router.navigate(['/admin']);\n        } else {\n          this.router.navigate(['/groups']);\n        }\n      },\n      (error) => {\n        console.log(error.message);\n      }\n    );\n  }\n\n  submitForm() {\n    this.authService.login(this.loginForm2.value).subscribe(\n      (response: any) => {\n        const role = response.role;\n        this.authService.setToken(response.token);\n        this.authService.setRoles(response.role);\n        if (role === ROLE_ADMIN) {\n          this.router.navigate(['/admin']);\n        } else {\n          this.router.navigate(['/groups']);\n        }\n      },\n      (error) => {\n        if (error.status === 403) {\n          this.loginForm2.get('email')?.setErrors({ badCredentials: true });\n        }\n      }\n    );\n  }\n\n  get email() {\n    return this.loginForm2.get('email');\n  }\n}\n","<div class=\"row mb-4\">\n  <div class=\"col\">\n    <div class=\"d-flex justify-content-center\">\n      <span class=\"display-4\">Login</span>\n    </div>\n  </div>\n</div>\n<div class=\"row d-flex justify-content-center\">\n  <div class=\"col-md-4\">\n    <form #loginForm=\"ngForm\" (ngSubmit)=\"login(loginForm)\">\n      <div class=\"row\">\n        <div class=\"col\">\n          <input\n          type=\"email\"\n          ngModel\n          name=\"email\"\n          id=\"email\"\n          placeholder=\"Enter your email\"\n          class=\"form-control mb-3\"\n        />\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col\">\n          <input\n          type=\"password\"\n          ngModel\n          name=\"password\"\n          id=\"password\"\n          placeholder=\"Enter your password\"\n          class=\"form-control mb-3\"\n        />\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col\">\n          <input type=\"submit\" class=\"btn btn-primary form-control\" value=\"Login\" />\n        </div>\n      </div>\n    </form>\n    <form [formGroup]=\"loginForm2\" (ngSubmit)=\"submitForm()\">\n      <div class=\"row mb-2\">\n        <div class=\"col\">\n          <div class=\"form-group\">\n            <label for=\"email\">Email</label>\n            <input\n              type=\"email\"\n              class=\"form-control\"\n              id=\"email\"\n              name=\"email\"\n              formControlName=\"email\"\n              required\n            />\n          </div>\n          <div class=\"form-group\">\n            <label for=\"password\">Password</label>\n            <input\n              type=\"password\"\n              class=\"form-control\"\n              id=\"password\"\n              name=\"password\"\n              formControlName=\"password\"\n              required\n            />\n          </div>\n        </div>\n      </div>\n      <div class=\"alert alert-danger\" *ngIf=\"email?.errors?.['badCredentials']\">\n        Incorrect email or password.\n      </div>\n      <div class=\"alert alert-danger\" *ngIf=\"email?.errors?.['required']&& (email?.touched || email?.dirty)\">\n        Provide an email address.\n      </div>\n      <div class=\"row\">\n        <div class=\"col\">\n          <button type=\"submit\" class=\"btn btn-primary form-control\">Login</button>\n        </div>\n      </div>\n    </form>\n  </div>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}