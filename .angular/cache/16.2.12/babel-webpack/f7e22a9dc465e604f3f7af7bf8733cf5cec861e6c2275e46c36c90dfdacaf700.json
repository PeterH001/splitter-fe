{"ast":null,"code":"import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { EMPTY, catchError, throwError } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/auth.service\";\nimport * as i2 from \"@angular/router\";\nclass AuthInterceptor {\n  constructor(authService, router) {\n    this.authService = authService;\n    this.router = router;\n  }\n  intercept(request, next) {\n    request = request.clone({\n      headers: request.headers.set('Authorization', 'Bearer ' + localStorage.getItem('jwtToken'))\n    });\n    return next.handle(request).pipe(catchError(error => {\n      switch (error.status) {\n        case 401:\n          this.authService.logout();\n          this.router.navigate(['/home']);\n          break;\n        case 403:\n          if (this.authService.isLoggedIn()) {\n            this.router.navigate(['/error/forbidden']);\n            return EMPTY;\n          }\n        default:\n          return throwError(() => error);\n      }\n      return throwError(() => error);\n    }));\n  }\n  static #_ = this.ɵfac = function AuthInterceptor_Factory(t) {\n    return new (t || AuthInterceptor)(i0.ɵɵinject(i1.AuthService), i0.ɵɵinject(i2.Router));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AuthInterceptor,\n    factory: AuthInterceptor.ɵfac\n  });\n}\nexport { AuthInterceptor };\nexport const AuthInterceptorProvider = {\n  provide: HTTP_INTERCEPTORS,\n  useClass: AuthInterceptor,\n  multi: true\n};","map":{"version":3,"names":["HTTP_INTERCEPTORS","EMPTY","catchError","throwError","AuthInterceptor","constructor","authService","router","intercept","request","next","clone","headers","set","localStorage","getItem","handle","pipe","error","status","logout","navigate","isLoggedIn","_","i0","ɵɵinject","i1","AuthService","i2","Router","_2","factory","ɵfac","AuthInterceptorProvider","provide","useClass","multi"],"sources":["C:\\Users\\Peti\\nest_projects\\splitwise\\frontend\\splitter-fe\\src\\app\\auth\\auth.interceptor.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n  HttpInterceptor,\n  HTTP_INTERCEPTORS,\n  HttpErrorResponse,\n} from '@angular/common/http';\nimport { EMPTY, Observable, catchError, throwError } from 'rxjs';\nimport { AuthService } from '../services/auth.service';\nimport { Router } from '@angular/router';\n\n@Injectable()\nexport class AuthInterceptor implements HttpInterceptor {\n  constructor(private authService: AuthService, private router: Router) {}\n\n  intercept(\n    request: HttpRequest<unknown>,\n    next: HttpHandler\n  ): Observable<HttpEvent<unknown>> {\n    request = request.clone({\n      headers: request.headers.set(\n        'Authorization',\n        'Bearer ' + localStorage.getItem('jwtToken')\n      ),\n    });\n\n    return next.handle(request).pipe(\n      catchError((error: HttpErrorResponse) => {\n        switch (error.status) {\n          case 401:\n            this.authService.logout();\n            this.router.navigate(['/home']);\n            break;\n          case 403:\n            if(this.authService.isLoggedIn()){\n              this.router.navigate(['/error/forbidden']);\n              return EMPTY;\n            }\n          default:\n            return throwError(() => error);\n        }\n        return throwError(() => error);\n      })\n    );\n  }\n}\n\nexport const AuthInterceptorProvider = {\n  provide: HTTP_INTERCEPTORS,\n  useClass: AuthInterceptor,\n  multi: true,\n};\n"],"mappings":"AACA,SAKEA,iBAAiB,QAEZ,sBAAsB;AAC7B,SAASC,KAAK,EAAcC,UAAU,EAAEC,UAAU,QAAQ,MAAM;;;;AAIhE,MACaC,eAAe;EAC1BC,YAAoBC,WAAwB,EAAUC,MAAc;IAAhD,KAAAD,WAAW,GAAXA,WAAW;IAAuB,KAAAC,MAAM,GAANA,MAAM;EAAW;EAEvEC,SAASA,CACPC,OAA6B,EAC7BC,IAAiB;IAEjBD,OAAO,GAAGA,OAAO,CAACE,KAAK,CAAC;MACtBC,OAAO,EAAEH,OAAO,CAACG,OAAO,CAACC,GAAG,CAC1B,eAAe,EACf,SAAS,GAAGC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC;KAE/C,CAAC;IAEF,OAAOL,IAAI,CAACM,MAAM,CAACP,OAAO,CAAC,CAACQ,IAAI,CAC9Bf,UAAU,CAAEgB,KAAwB,IAAI;MACtC,QAAQA,KAAK,CAACC,MAAM;QAClB,KAAK,GAAG;UACN,IAAI,CAACb,WAAW,CAACc,MAAM,EAAE;UACzB,IAAI,CAACb,MAAM,CAACc,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC;UAC/B;QACF,KAAK,GAAG;UACN,IAAG,IAAI,CAACf,WAAW,CAACgB,UAAU,EAAE,EAAC;YAC/B,IAAI,CAACf,MAAM,CAACc,QAAQ,CAAC,CAAC,kBAAkB,CAAC,CAAC;YAC1C,OAAOpB,KAAK;;QAEhB;UACE,OAAOE,UAAU,CAAC,MAAMe,KAAK,CAAC;;MAElC,OAAOf,UAAU,CAAC,MAAMe,KAAK,CAAC;IAChC,CAAC,CAAC,CACH;EACH;EAAC,QAAAK,CAAA,G;qBAhCUnB,eAAe,EAAAoB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,WAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,MAAA;EAAA;EAAA,QAAAC,EAAA,G;WAAf1B,eAAe;IAAA2B,OAAA,EAAf3B,eAAe,CAAA4B;EAAA;;SAAf5B,eAAe;AAmC5B,OAAO,MAAM6B,uBAAuB,GAAG;EACrCC,OAAO,EAAElC,iBAAiB;EAC1BmC,QAAQ,EAAE/B,eAAe;EACzBgC,KAAK,EAAE;CACR"},"metadata":{},"sourceType":"module","externalDependencies":[]}